<!DOCTYPE html>
<html lang="es">
<head>
    <title>Grafo del Zettelkasten</title>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/vis-network.min.js"></script>
    <style type="text/css">
        body { margin: 0; padding: 0; overflow: hidden; font-family: sans-serif; }
        #mynetwork { width: 100vw; height: 100vh; background-color: #f9f9f9; border: 1px solid lightgray; }
        #loadingBar { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(255,255,255,0.8); display: flex; justify-content: center; align-items: center; font-size: 2em; z-index: 100; }
    </style>
</head>
<body>
    <div id="loadingBar">Cargando grafo...</div>
    <div id="mynetwork"></div>

    <script type="text/javascript">
        var nodes = new vis.DataSet({nodes_json});
        var edges = new vis.DataSet({edges_json});

        var container = document.getElementById("mynetwork");
        var data = { nodes: nodes, edges: edges };
        var options = {
            nodes: {
                shape: "box",
                size: 20,
                font: { size: 12, color: "#333333" },
                borderWidth: 1,
                shadow: true
            },
            edges: {
                width: 1,
                shadow: true,
                color: { inherit: "from" }
            },
            physics: {
                enabled: true,
                barnesHut: {
                    gravitationalConstant: -2000,
                    centralGravity: 0.3,
                    springLength: 95,
                    springConstant: 0.04,
                    damping: 0.09,
                    avoidOverlap: 0.5
                },
                solver: "barnesHut"
            },
            interaction: {
                navigationButtons: true,
                keyboard: true
            },
            groups: {
                fenomeno: { color: { background: "#FFC107", border: "#FF9800" } },
                categoria: { color: { background: "#4CAF50", border: "#388E3C" } },
                isomorfismo: { color: { background: "#2196F3", border: "#1976D2" } },
                tecnica: { color: { background: "#9C27B0", border: "#7B1FA2" } },
                dominio: { color: { background: "#F44336", border: "#D32F2F" } },
                concepto: { color: { background: "#00BCD4", border: "#0097A7" } },
                mapeo: { color: { background: "#FF5722", border: "#E64A19" } },
                desconocido: { color: { background: "#BDBDBD", border: "#9E9E9E" } }
            }
        };

        var network = new vis.Network(container, data, options);

        network.on("stabilizationIterationsDone", function () {
            network.setOptions( { physics: false } );
            document.getElementById("loadingBar").style.display = "none";
        });

        network.on("click", function (params) {
            if (params.nodes.length > 0) {
                var nodeId = params.nodes[0];
                var node = nodes.get(nodeId);
                if (node && node.title) {
                    // Aquí podrías abrir el archivo o mostrar más detalles
                    // Por ahora, solo muestra el título en la consola
                    console.log("Detalles de la nota: ", node.title);
                    alert(node.title);
                }
            }
        });

    </script>
</body>
</html>

